(this.$WP=this.$WP||[]).push(["VANuRt",(e,r)=>{"use strict";var o,a,n,l,i,t,s,d,u,c,h,g,p,w,f,S,v,C="https://smartlock.google.com",m=({options:e,onReady:r,onShowOverlay:a,onFlowStepChange:n,forwardedRef:l})=>{var[t,s]=o.useState(),[d,u]=o.useState(),[c,f]=o.useState(!1),S="MOBILE"===o.useContext(i).viewportCategory,{onSuccess:v,isFullWidthMobile:m}=e,y=o.useCallback((e=>{var r,o=e.resultData||"";if(o){var a=(e=>{var r={};try{r=JSON.parse(e)}catch(r){return console.error(`Error parsing controller result data: ${e}`),null}return"object"!=typeof r?(console.error("Parsed controller result is not an object."),null):{userId:r.user_id,hasCreatedMember:!!r.hasCreatedMember,hasAcceptedTermsOfUse:!!r.hasAcceptedTermsOfUse,loginProvider:r.loginProvider}})(o);null!=a&&a.hasCreatedMember,v&&v(a)}else v&&v(null);e.jsCallback&&(r=e.jsCallback)&&console.error(`Non-empty JSCallback is returned from RegController: ${r}`)}),[v]),O=o.useCallback((e=>{e>100&&s(S&&m?"100%":e)}),[S,m]),{displayOnShowOverlay:b,onClose:I,onFailure:k}=e,x=o.useCallback((o=>{var l=o,i=(e=>{if(!e)return null;if(!e.origin||0!==e.origin.indexOf("https")||e.origin!==document.location.origin)return null;if(!e.data||!e.data.indexOf||-1===e.data.indexOf("action"))return null;try{var r=JSON.parse(e.data);return r.action?r:null}catch(e){return null}})(l);if((e=>{e&&e.origin&&0===e.origin.indexOf(C)&&e.data&&e.data.type&&e.source&&e.source.postMessage({type:"verifyAck",data:e.data.data},C)})(l),i){var{action:t}=i;switch(t){case"successClose":y(i);break;case"reloadWindow":console.error("Unexpected reload window message is received from RegController iframe");break;case"fwdToRelativeUrl":var s=i.url||"";s||console.error("No url specified to forward to."),0!==s.indexOf("/")&&console.error(`Cannot forward to absolute url: ${s}`),window.location=s;break;case"resizeFrame":O(i.width),i.height>100&&(e.ignoreScreenHeight?u(i.height):u(Math.min(i.height,window.innerHeight)));break;case"domReady":f(!0),r&&r();break;case"dismiss":I&&I();break;case"showOverlay":b&&a&&a();break;case"generalError":k&&k();break;case"splash":case"regSignIn":case"regSignUp":case"regForgotPassword":n&&n(t)}}}),[e.ignoreScreenHeight,y,b,a,n,I,r,O,k]);g("message",x);var R=o.useMemo((()=>{var r=e.extraQueryParams||{};Object.keys(r).forEach((e=>{void 0===r[e]&&delete r[e]}));var o=new URLSearchParams({flow:e.flow,flowOrigin:e.flowOrigin,pid:`${e.pid}`,hideNavigation:"true",userRequestedForce:"true",returnTo:"",isLithium:"true",...r});return e.mcid&&o.append("mcid",`${e.mcid}`),e.locationId&&o.append("locationId",`${e.locationId}`),e.stateToken&&o.append("stateToken",e.stateToken),void 0!==e.requireSecure&&o.append("requireSecure",`${String(!!e.requireSecure)}`),`/RegistrationController?${o.toString()}`}),[e.extraQueryParams,e.flow,e.flowOrigin,e.locationId,e.mcid,e.pid,e.requireSecure,e.stateToken]);return w("div",{className:h("kQpCd o B-",{"bWCce Ra":!S}),style:{width:t,height:d},children:w(p,{className:"eBsLQ _R B- o",src:R,title:"regcontroller",style:{width:t,height:d,display:c?"block":"none"},ref:l,scrolling:"no"})})},y=({options:e,closeX:r})=>{var a="MOBILE"===o.useContext(i).viewportCategory,[n,l]=o.useState(!1),t=o.useCallback((()=>{e.displayOnShowOverlay||l(!0)}),[e.displayOnShowOverlay]),s=o.useCallback((()=>{l(!0)}),[]),d=o.useMemo((()=>w(S,{options:e,onReady:t,onShowOverlay:s})),[t,e,s]);return f(u,{onClose:e.onClose,containerProps:{backgroundColor:"transparent",disableBodyScroll:!0},bodyProps:{isFullBleed:!0},enableCloseIcon:n&&r,roundedCorners:!a,hideBoxShadow:e.hideBoxShadow,children:[w("div",{style:{display:n?"block":"none"},children:d}),!n&&w("div",{className:"DlpIA",children:w(c,{size:"large",variant:"primary"})})]})},O=()=>{var{userId:e}=o.useContext(t),[r]=o.useContext(s),i=o.useContext(d),u=r.params.geoId||void 0,[c,h]=o.useState({flow:"CORE_COMBINED",flowOrigin:"join",pid:-1}),[g,p]=o.useState({closeX:!0}),f=l(),S=o.useRef(void 0),C=n((()=>w(v,{options:c,closeX:g.closeX})),{},[c,g]);return{login:o.useCallback((o=>e&&!o.forceLogin?Promise.resolve({userId:e,hasCreatedMember:null}):S.current?S.current:a()?("undefined"!=typeof window&&(window.location=`/RegistrationController?flow=${encodeURIComponent(o.flow||"CORE_COMBINED")}&pid=${encodeURIComponent(String(o.pid||-1))}&returnTo=${encodeURIComponent(r.path)}&fullscreen=true`),new Promise((()=>{}))):(S.current=new Promise((e=>{h({flow:o.flow||"CORE_COMBINED",flowOrigin:o.flowOrigin||"join",pid:o.pid||-1,isFullWidthMobile:o.isFullWidthMobile||!1,hideBoxShadow:o.hideBoxShadow||!1,extraQueryParams:o.extraQueryParams||{},displayOnShowOverlay:o.deferShowOverlay,requireSecure:o.requireSecure||!1,locationId:u||-1,onSuccess:r=>{var a={userId:(null==r?void 0:r.userId)||null,hasCreatedMember:!(null==r||!r.hasCreatedMember),loginProvider:null==r?void 0:r.loginProvider};o.onSuccess&&o.onSuccess(a),C.close(),S.current=null,i({userId:a.userId}),e(a)},onClose:()=>{f({module:"regoverlay",action:"closed",context:[u||"",o.flow].join("|"),value:o.pid||void 0,nonInteraction:!1}),C.close(),S.current=null,o.onClose&&o.onClose()},onFailure:()=>{o.onFailure&&o.onFailure()}}),p({closeX:!1!==o.closeX}),C.open()})),S.current)),[e,r.path,u,C,i,f]),close:C.close}},b=({flow:e,flowOrigin:r="login",pid:a=-1,isFullWidthMobile:n=!1,forceLogin:l=!1,extraQueryParams:i={},deferShowLogin:s=!0,requireSecure:u=!1,ignoreScreenHeight:c=!1,onLoginSuccess:h,onLoginFailure:g,onShowOverlay:p,onFlowStepChange:f,forwardedRef:v})=>{var{userId:C}=o.useContext(t),m=o.useContext(d);return C&&!l?null:w(S,{options:{flow:e,flowOrigin:r,pid:a,isFullWidthMobile:n,extraQueryParams:i,displayOnShowOverlay:s,requireSecure:u,ignoreScreenHeight:c,onSuccess:e=>{m({userId:(null==e?void 0:e.userId)||null}),h&&h()},onFailure:()=>{g&&g()}},onShowOverlay:p,onFlowStepChange:f,forwardedRef:v})};return[()=>{S=m,v=y,e({AuthGate:b,default:O})},[e=>o=e,e=>a=e.default,e=>n=e.useVDOMPortal,e=>l=e.useGARecorder,e=>(i=e.Device,t=e.Visitor,s=e.Route,d=e.Authenticate),e=>u=e.default,e=>c=e.LoadingSpinner,e=>h=e.default,e=>g=e.useWindow,e=>p=e.EmbeddedContent,e=>(w=e.jsx,f=e.jsxs)]]},["cDcdfi","SfdMbo","vq6MSq","fsml46","2R4xv2","O8LbtK","V08PS7","jSLlaY","Dg5_-9","m5ZZFI","F5FCuN"]]);
